<!DOCTYPE html>
<html lang="en">
<head>
  <title>NewsPaper List Management</title>
 <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>  
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <style>
  .container{
  min-height:100%;
  height:100%;
  }
  .reduceWidth{
	margin-left:-25px;
  }
  </style>
  
</head>


<body>
<!--selectScreen container starts-->
<div class="container" id="selectScreen">
  
  <div class="btn-group btn-group-justified">
    <a href="#" class="btn btn-success " id="btnAdd"><span class="glyphicon glyphicon-plus-sign"></span> Add</a>
    <a href="#" class="btn btn-warning " id="btnEdit"><span class="glyphicon glyphicon-edit"></span> Edit</a>
    <a href="#" class="btn btn-primary" id="btnDelete"><span class="glyphicon glyphicon-remove-sign"></span> Delete</a>
  </div>
  
  <br>
  
  <div class="row" id="addItem" role="form" >
	  <div class="col-xs-8">
	  <input type="text" class="form-control input-xs" placeholder="Item Name" id="itemName">
	  </div>
	  
	  <div class="col-xs-4">
	  <input type="number" class="form-control input-xs" placeholder="Price" id="itemPrice">
	  </div>
	  
	 
  
	</div>
	<div class="submitClass">
	<br>
	
	<button type="submit" id="btnSubmit"  class=" input-xs btn btn-success" disabled><span class="glyphicon glyphicon-check"></span>  Done</button>

	 
	<br><br> 
	</div>
	<div class="panel panel-default">
  <div class="panel-heading">Select NewsPapers
  <button type="submit" id="btnSelected" class="btn btn-success" disabled style="float:right;margin-top:-7px;"><span class="glyphicon glyphicon-thumbs-up"></span> Selected</button>  
  </div>
  <div class="panel-body">

<div class="row">
         
       
			<div class="col-xs-12">  
            <div  style="overflow: auto;">
        		<ul class="list-group checked-list-box" id="listGroup" role='listview'>                 
				  
                </ul>
            </div>
        </div>
  
  
  
  </div>
    <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        
        <div class="modal-body" id="popUpMsg">
        
        </div>
        <div class="modal-footer">
          
          <center>
		  <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal" id="deleteItems">Close</button>
		  <button type="button" class="btn btn-success btn-sm" data-dismiss="modal" id="closeDelete">Close</button>
		  </center>
        </div>
      </div>
      
    </div>
  </div>
  
    <div class="modal fade" id="myModalDlt" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        
        <div class="modal-body" id="popUpMsgDlt">
        
        </div>
        <div class="modal-footer">
          
          <center>
		  <button type="button" class="btn btn-success btn-sm" data-dismiss="modal" id="deleteItems">Close</button>  
		  </center>
        </div>
      </div>
      
    </div>
  </div>

</div>
   </div>
  </div>
  <!--selectScreen container ends-->
<!--addEditScreen container starts-->
<div class="container" id="addEditScreen">
	<br>
	  <div class="row" role="form" >
		  <div class="col-xs-12">
			<input type="text" class="form-control input-xs" placeholder="Newspaper Name" >
		  </div>	  	  
		  
	  </div>
	  <br>
	  <div class="panel panel-default">
	  
	  
	  
	   <div class="panel-heading">
	   
	   

  
	<div class="row">	
		<center><div class="col-sm-8" style="margin-top:-20px;margin-bottom:-10px;"><h3>Day</span></h3></div>
		<center><div class="col-sm-4" style="margin-top:-20px;margin-bottom:-10px;"><h3>Price</span></h3></div>
		
	</div>
  
  
  </div>
  <div class="panel-body">

<div class="row">
         
       
			<div class="col-xs-12">  
            <div  style="overflow: auto;">
        		<ul class="list-group checked-list-box" id="listGroup" role='listview'>                 
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Monday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	

				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Tuesday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>


				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Wednesday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	
				
				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Thursday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	
				
				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Friday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	
				
				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Saturday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	
				
				<br>
				<div class="row" >
					<div class="col-xs-8">
						<input type="text" class="form-control" value="Sunday" readonly/>
					</div>  
					<div class="col-xs-4">
						<input type="text" class="form-control" placeholder="00.00"/>
					</div>  
				</div>	
				
                </ul>
            </div>
			</div>
		</div>
	  
	  
	  </div>
  
	</div>
	
	
	<div class="btn-group btn-group-justified">
		
			<a href="#" class="btn btn-success " id="btnSubmit"><span class="glyphicon glyphicon-check"></span> Done</a>
			<a href="#" class="btn btn-warning " id="btnEdit"><span class="glyphicon glyphicon-plus-sign"></span> Add More</a>
			
		
		
	</div>	
</div>


<!--addEditScreen container ends-->
</body>
<script>

  $(document).ready( function() {
	
	$("#addEditScreen").hide();
	$('#myModal').css({'position':'fixed','height':'100%','top': '30%'});
	$('#myModalDlt').css({'position':'fixed','height':'100%','top': '30%'});
//selectScreen Code starts//	
  if (typeof(Storage) != "undefined") {  
  

	
    for(var i=0;i<localStorage.length;i++)
	{
	var str=localStorage.getItem(localStorage.key(i)).split("|");	
	var newItem = '<li class="list-group-item selectItemList" id = listId_'+ localStorage.key(i) +' > '+str[0]+'<span class="label label-default" style="float:right; font-size:15px"  id =priceId_'+ localStorage.key(i) +'  >'+str[1]+'</span></li>';	
	
	$('#listGroup').append(newItem);		
	}
} else {
    alert("Sorry, your browser does not support Web Storage...");
}
  $('#addItem').hide();
  $('.submitClass').hide();
  
  $('.list-group.checked-list-box .selectItemList').each(makeList);  
  $.mobile.loading().hide();  
});

function makeList() {
        
        // Settings
         var $widget = $(this),
            $checkbox = $('<input type="checkbox" class="hidden" />'),
            color = ($widget.data('color') ? $widget.data('color') : "primary"),
            style = ($widget.data('style') == "button" ? "btn-" : "list-group-item-"),
            settings = {
                on: {
                    icon: 'glyphicon glyphicon-check'
                },
                off: {
                    icon: 'glyphicon glyphicon-unchecked'
                }
            };
            
        $widget.css('cursor', 'pointer')
        $widget.append($checkbox);

        // Event Handlers
        $widget.on('click', function () {
			
            $checkbox.prop('checked', !$checkbox.is(':checked'));
            $checkbox.triggerHandler('change');
            
        });
        $checkbox.on('change', function () {
            updateDisplay();
        });
          

        // Actions
        function updateDisplay() {
            var isChecked = $checkbox.is(':checked');
			
            // Set the button's state
            $widget.data('state', (isChecked) ? "on" : "off");

            // Set the button's icon
            $widget.find('.state-icon')
                .removeClass()
                .addClass('state-icon ' + settings[$widget.data('state')].icon);

            // Update the button's color
            if (isChecked) {
                $widget.addClass(style + color + ' active');
				$('#btnSelected').removeAttr('disabled');
            } else {
                $widget.removeClass(style + color + ' active');
				
				var count=0;
				$('input[type=checkbox]').each(function (idx,chk)
				{
					if($(chk).is(':checked'))
					count++;
				});
				if(count==0)
				$('#btnSelected').prop("disabled",true);
				
            }
        }

        // Initialization
        function init() {
            
            if ($widget.data('checked') == true) {
                $checkbox.prop('checked', !$checkbox.is(':checked'));
            }
            
            updateDisplay();

            // Inject the icon if applicable
            if ($widget.find('.state-icon').length == 0) {
                $widget.prepend('<span class="state-icon ' + settings[$widget.data('state')].icon + '"></span>');
            }
        }
        init();
    }
   
    $('#btnNotHere').on('click', function(event) {
        event.preventDefault(); 
        var checkedItems = {}, counter = 0;
        $("#check-list-box li.active").each(function(idx, li) {
            checkedItems[counter] = $(li).text();
            counter++;
        });
        //$('#display-json').html(JSON.stringify(checkedItems, null, '\t'));
		alert(JSON.stringify(checkedItems, null, '\t'));
    });

		$("#btnEdit").click(function(){
		
		var count=0;
		//document.write($widget);
		$('input[type=checkbox]').each(function (idx,chk)
		{
			if($(chk).is(':checked'))
			{
			$(chk).prop('checked',false);
			count++;
			}
			
			
		});
		
		
		
		if(count==0)
		{
			$("#popUpMsg").text("Hey! You did not select any newspaper to edit !!");				
			$("#myModal").modal();
			$("#closeDelete").text("Close");
			$("#deleteItems").hide();
		}
		else{
		
		
        var checkedItems = {}, counter = 0;
        $("li.active").each(function(idx, li) {
		$('#btnSelected').prop("disabled",true);
            checkedItems[counter] = $(li).text();
			
			var spanPrice="'"+$(li).children("span").text()+"'";
			$(li).children("span").remove();
			var liText="'"+$(li).text()+"'";
			var liHeight=$("li.active").outerHeight();
			var items=$(li).attr('id').split("_");	
				
			var itemId=items[1];
			$(li).after('<div class="row editingDiv" id=editDiv_'+itemId+' ><div class="col-xs-8 " ><input type="text" value='+ liText+' class="form-control " id=editName_'+itemId+' /></div>   <div class="col-xs-3 reduceWidth"><input type="text" value='+ spanPrice + 'class="form-control" id=editPrice_'+itemId+' /></div>    <div class="col-xs-1 reduceWidth"><button type="button" class="btn btn-primary subEditButton" id=editBtn_'+itemId+' ><span class="glyphicon glyphicon-ok-sign"></span></button></div>		</div>');
			$(li).hide();
			$("#editName_"+itemId).select();
			$(li).removeClass('active');
            counter++;
        });
		
		}
		

});


$(document).on('click', '.subEditButton', function(){ 
	
	var btnId = $(this).attr('id').split("_");	
	
	
	$("#listId_"+btnId[1]).text($("#editName_"+btnId[1]).val());	
	$("#priceId_"+btnId[1]).text($("#editPrice_"+btnId[1]).val());
	
	
	
	
	$("#listId_"+btnId[1]).append('<span class="label label-default" style="float:right; font-size:15px" id =priceId_'+ btnId[1] +'>'+  parseFloat($("#editPrice_"+btnId[1]).val()).toFixed(2)+'</span>');
	$("#listId_"+btnId[1]).show();
	$('.list-group.checked-list-box .selectItemList').each(makeList); 
	localStorage.setItem(btnId[1],$("#editName_"+btnId[1]).val()+"|"+parseFloat($("#editPrice_"+btnId[1]).val()).toFixed(2)); 
	$("#editDiv_"+btnId[1]).remove();
	$('#btnSelected').prop("disabled",true);
    
 });


	
	
	
$("#itemPrice").blur(function(){  
  
	if ($("#itemPrice").val()=='')
	alert("Please enter a valid price");
  
  });
  
  $("#itemPrice").keyup(function(){  
  if($('#itemName').val()!=''&&$('#itemPrice').val()!='')
  $('#btnSubmit').removeAttr("disabled");
  else if($('#itemName').val()==''||$('#itemPrice').val()=='')
  $('#btnSubmit').prop("disabled",true);
});

  $("#itemName").keyup(function(){
  if($('#itemName').val()!=''&&$('#itemPrice').val()!='')
  $('#btnSubmit').removeAttr("disabled");
  else if($('#itemName').val()==''||$('#itemPrice').val()=='')  
  $('#btnSubmit').prop("disabled",true);
});

	$("#btnSubmit").click(function(){
	
	/*var nextId = (localStorage.length+1);
	if($("#btnAdd").html()=='<span class="glyphicon glyphicon-minus-sign"></span> Cancel')
		{
			$("#btnAdd").html('<span class="glyphicon glyphicon-plus-sign"></span> Add');
			$("#btnAdd").toggleClass('btn-success btn-danger');
		}
	var newItem = '<li class="list-group-item selectItemList" id = listId_'+ nextId +'> '+$("#itemName").val()+'<span class="label label-default" style="float:right; font-size:15px" id =priceId_'+ nextId +'>'+parseFloat($("#itemPrice").val()).toFixed(2)+'</span></li>';	
	
	
	
	
	$('#listGroup').append(newItem);	
	$('.list-group.checked-list-box .selectItemList').each(makeList); 
	
	
	$("#listId_"+ nextId).addClass('list-group-item-info');
    setTimeout(function(){
      $("#listId_"+ nextId).removeClass('list-group-item-info');}, 3000);
	
	if (typeof(Storage) != "undefined") {
    // Store
	var nextId = localStorage.length+1;
	
    localStorage.setItem(nextId,$("#itemName").val()+"|"+parseFloat($("#itemPrice").val()).toFixed(2));    
} else {
    alert("Sorry, your browser does not support Web Storage...");
}
	
	$("#itemName").val('');
	$("#itemPrice").val('');
	$('#btnSubmit').prop("disabled",true);
	$('#addItem').hide();
		$('.submitClass').hide(); 
		
		$("#popUpMsg").text("Newspaper added successfully. Well Done!!");
		$("#myModal").modal();
		$("#closeDelete").text("Close");
		$("#deleteItems").hide();*/
		
		$("#addEditScreen").hide();
		$("#selectScreen").show();
	
	});
	
	$("#btnAdd").click(
	
	function(){	
	$("#selectScreen").hide();
	$("#addEditScreen").show();
		
	});
	
	$("#btnDelete").click(
	
		function(){
		//localStorage.clear();
		var count=0;
		//document.write($widget);
		$('input[type=checkbox]').each(function (idx,chk)
		{
			if($(chk).is(':checked'))
			count++;
		});
		
		
		
		if(count>0)
		{
		$("#popUpMsg").text("Do you really want to delete selected NewsPapers?? ");		
		$("#myModal").modal();
		$("#deleteItems").show();
		$("#deleteItems").text("Oh Yes!!");
		$("#closeDelete").text("I am Consfused!!");
		}
		else
		{
			$("#popUpMsg").text("Hey! You did not select any newspaper !!");
			$("#myModal").modal();
			$("#closeDelete").text("Close");
			$("#deleteItems").hide();
		}
		
		
		}
	);
	
	$("#deleteItems").click(function()
	{
		$("li.active").each(function(idx,li)
		{
			var listIdStr=$(li).attr('id').split("_");			
			
			localStorage.removeItem(listIdStr[1]);
			$(li).remove();
			
			
		});
		$(this).makeList;
		$("#popUpMsgDlt").text("NewsPapers deleted successfully.");
			$("#myModalDlt").modal();
			
	});
	
	$("#btnSelected").click(function()
	{
		$("#popUpMsg").text("NewsPapers have been selected successfully");
		$("#myModal").modal();
		$("#closeDelete").text("Close");
		$("#deleteItems").hide();
		
	});
	//selectScreen Code ends//	
  </script>
</html>
